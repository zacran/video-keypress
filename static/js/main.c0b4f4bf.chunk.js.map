{"version":3,"sources":["components/Chart.js","hooks/keybindMap.js","App.js","index.js"],"names":["MIN_EVENT_DURATION","convertToMilliseconds","value","formatTime","toFixed","useStyles","makeStyles","theme","root","flexGrow","margin","maxWidth","paper","padding","spacing","fontSize","textAlign","color","palette","text","secondary","control","Chart","props","useState","formattedData","setFormattedData","derivedFields","setDerivedFields","cachedFormattedDataSize","setCachedFormattedDataSize","classes","useEffect","interval","setInterval","length","data","filter","obj","console","log","uniqueBehaviors","forEach","event","indexOf","push","tempDerivedFields","behavior","occurences","totalDuration","matchingEvents","map","derivedField","avgDuration","state","computeDerivedFields","clearInterval","isVideoLoaded","videoFilePath","areEventsEmpty","events","headerRows","type","id","metadata","duration","eventsExist","newEventExists","latestEvent","end","start","find","warn","formattedEvent","className","Grid","container","item","xs","Paper","Typography","variant","display","gutterBottom","align","width","height","chartType","options","timeline","colorByRowLabel","showBarLabels","colors","Keybinds","key","code","r","g","b","a","active","SPACE_KEYS","button","smallButton","marginTop","largeButton","toolbar","minHeight","maxHeight","title","menu","border","divider","borderRadius","shape","StyledMenu","withStyles","Menu","elevation","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","StyledMenuItem","backgroundColor","primary","main","common","white","MenuItem","App","isPlaying","playedSeconds","loadedSeconds","keybinds","KeybindMap","activeRecords","setState","handleKeyevent","callback","keybind","String","recordKeydown","activity","recordKeyup","dataEvents","useEventListener","includes","preventDefault","hiddenInput","useRef","anchorEl","setAnchorEl","ref","onChange","uploadedFile","target","files","video","document","createElement","URL","createObjectURL","src","addEventListener","parseFloat","videoFileName","name","fileName","scoringDate","Date","now","scoringDateText","toISOString","activeElement","blur","style","keepMounted","open","Boolean","onClose","ListItemText","AppBar","position","background","Toolbar","component","alignItems","Tooltip","IconButton","aria-label","onClick","e","current","click","Divider","orientation","flexItem","dataStr","encodeURIComponent","JSON","stringify","downloadAnchorNode","setAttribute","body","appendChild","remove","aria-haspopup","currentTarget","url","playing","controls","onDuration","onProgress","progress","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.c0b4f4bf.chunk.js","sourcesContent":["import React, { useState, useEffect, Component } from \"react\";\nimport { Chart as GoogleChart } from \"react-google-charts\";\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport { makeStyles } from '@material-ui/core/styles';\nimport \"../App.css\";\n\nconst COMPUTE_DERIVED_FIELDS_INTERVAL = 500;\nconst MIN_EVENT_DURATION = 0.1;\n\nfunction convertToMilliseconds(value) {\n    return value * 1000\n}\n\nfunction formatTime(value) {\n    return `${value.toFixed(2)}ms`;\n}\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        flexGrow: 1,\n        margin: 'auto',\n        maxWidth: '600px'\n    },\n    paper: {\n        padding: theme.spacing(1),\n        fontSize: '12px',\n        textAlign: 'center',\n        color: theme.palette.text.secondary,\n    },\n    control: {\n        padding: theme.spacing(2),\n    },\n}));\n\nconst Chart = (props) => {\n    const [formattedData, setFormattedData] = useState([]);\n    const [derivedFields, setDerivedFields] = useState([]);\n    const [cachedFormattedDataSize, setCachedFormattedDataSize] = useState(0);\n\n    const classes = useStyles();\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            if (formattedData.length !== cachedFormattedDataSize) {\n                setCachedFormattedDataSize(formattedData.length);\n                computeDerivedFields();\n            }\n        }, COMPUTE_DERIVED_FIELDS_INTERVAL);\n        return () => clearInterval(interval);\n    });\n\n    function computeDerivedFields() {\n        // Remove header row of formatted data\n        var data = formattedData.filter(obj => typeof obj[0] === 'string' && obj[1] !== 'Meta');\n        console.log(formattedData);\n        // Find unqiue behaviors in existing data\n        const uniqueBehaviors = [];\n        data.forEach(event => {\n            if (uniqueBehaviors.indexOf(event[0]) === -1) {\n                uniqueBehaviors.push(event[0])\n            }\n        });\n\n        var tempDerivedFields = [];\n\n        // Derive fields for each unique behavior\n        uniqueBehaviors.forEach(behavior => {\n            var occurences = 0, totalDuration = 0;\n            var matchingEvents = data.filter(event => event[0] === behavior);\n\n            console.log(\"finding derived fields for \" + behavior + \" found \" + matchingEvents.length + \" events\");\n\n            occurences = matchingEvents.length;\n            matchingEvents.map(event => {\n                totalDuration += (event[3] - event[2]);\n            });\n\n            var derivedField = {\n                behavior: behavior,\n                occurences: occurences,\n                totalDuration: totalDuration,\n                avgDuration: (totalDuration / occurences)\n            }\n\n            tempDerivedFields.push(derivedField);\n        });\n\n        setDerivedFields((derivedFields) => {\n            derivedFields = tempDerivedFields;\n            console.log(derivedFields);\n\n            return derivedFields;\n        });\n\n        props.state.derivedFields = derivedFields;\n    };\n\n    useEffect(() => {\n        var isVideoLoaded = (props.state.videoFilePath !== '');\n        var areEventsEmpty = (formattedData.length === 0 && props.state.data.events && props.state.data.events.length === 0);\n\n        if (isVideoLoaded && areEventsEmpty) {\n            var headerRows = [\n                [\n                    { type: 'string', id: 'Behavior' },\n                    { type: 'string', id: 'Event' },\n                    { type: 'number', id: 'Start' },\n                    { type: 'number', id: 'End' },\n                ],\n                [\n                    \"Behavior\", \"Meta\", 0, convertToMilliseconds(props.state.data.metadata.duration)\n                ]\n            ];\n            setFormattedData(headerRows);\n        }\n\n        // Check if events exist to avoid running code when idle\n        var eventsExist = (props.state.data.events && props.state.data.events.length > 0);\n        // Check if a new event exists -- length of data.events plus 2 base header rows\n        var newEventExists = (props.state.data.events.length + 2 > formattedData.length);\n\n        // Add new event and compute derived fields when new record is persisted\n        if (eventsExist && newEventExists) {\n            // Get latest row\n            var latestEvent = props.state.data.events[props.state.data.events.length - 1];\n\n            // for display purposes, set a minimum value for durations\n            if ((latestEvent.end - latestEvent.start) < MIN_EVENT_DURATION) latestEvent.end += MIN_EVENT_DURATION;\n\n            // Seach existing records for similar start, end, duration times and adjust by the MIN_EVENT_DURATION\n            // This is to account for key presses that happen faster than the update cycle of React\n            var similarEvent = props.state.data.events.find(obj => {\n                if (obj.id !== latestEvent.id) {\n                    if (obj.start === latestEvent.start) {\n                        console.warn(\"Adjusted event start time due to existing similar events: \" + latestEvent.id);\n                        latestEvent.start += (MIN_EVENT_DURATION + (0.1 * MIN_EVENT_DURATION));\n                    }\n\n                    if (obj.behavior === latestEvent.behavior && obj.end === latestEvent.start) {\n                        console.warn(\"Adjusted event start time due to existing similar events: \" + latestEvent.id);\n                        latestEvent.start += (0.1 * MIN_EVENT_DURATION);\n                    }\n\n                    if (obj.end === latestEvent.end) {\n                        console.warn(\"Adjusted event end time due to existing similar events: \" + latestEvent.id);\n                        latestEvent.end += (MIN_EVENT_DURATION + (0.1 * MIN_EVENT_DURATION));\n                    }\n                }\n            });\n\n            var formattedEvent = [\n                latestEvent.behavior,\n                \"Event: #\" + latestEvent.id,\n                convertToMilliseconds(latestEvent.start),\n                convertToMilliseconds(latestEvent.end)\n            ];\n            setFormattedData(formattedData => [...formattedData, formattedEvent]);\n        }\n    });\n\n    return (\n        <div className=\"Row\">\n            {derivedFields.length > 0 ?\n                derivedFields.map((derivedField) =>\n                    <Grid container className={classes.root} spacing={2} key={derivedField.behavior}>\n                        <Grid item xs={3}>\n                            <Paper className={classes.paper}>\n                                <Typography variant=\"caption\" display=\"inline\" gutterBottom>    Behavior:   </Typography>\n                                <Typography variant=\"subtitle2\" display=\"block\" align=\"center\" gutterBottom >{derivedField.behavior}</Typography>\n                            </Paper>\n                        </Grid>\n                        <Grid item xs={3}>\n                            <Paper className={classes.paper}>\n                                <Typography variant=\"caption\" display=\"inline\" gutterBottom>    Occurences: </Typography>\n                                <Typography variant=\"subtitle2\" display=\"block\" align=\"center\" gutterBottom >{derivedField.occurences}</Typography>\n                            </Paper>\n                        </Grid>\n                        <Grid item xs={3}>\n                            <Paper className={classes.paper}>\n                                <Typography variant=\"caption\" display=\"inline\" gutterBottom>    Avg Duration:   </Typography>\n                                <Typography variant=\"subtitle2\" display=\"block\" align=\"center\" gutterBottom >{formatTime(derivedField.avgDuration)}</Typography>\n                            </Paper>\n                        </Grid>\n                        <Grid item xs={3}>\n                            <Paper className={classes.paper}>\n                                <Typography variant=\"caption\" display=\"inline\" gutterBottom>    Total Duration:    </Typography>\n                                <Typography variant=\"subtitle2\" display=\"block\" align=\"center\" gutterBottom >{formatTime(derivedField.totalDuration)}</Typography>\n                            </Paper>\n                        </Grid>\n                    </Grid>\n                )\n                : \"\"}\n            <div className=\"GoogleChart\">\n                {\n                    formattedData.length > 1 ?\n                        <GoogleChart\n                            width={'840px'}\n                            height={'100%'}\n                            chartType=\"Timeline\"\n                            data={formattedData}\n                            options={{\n                                timeline: {\n                                    colorByRowLabel: true,\n                                    margin: 'auto'\n                                },\n                            }}\n                            options={{\n                                timeline: {\n                                    showBarLabels: false,\n                                    colorByRowLabel: true\n                                },\n                                colors: ['transparent', '#469FAE', '#3ECDB6', '#F7D9A6', '#F67E5C', '#CA1252', '#DD5B5C', '#D9959A', '#938D99', '#5E614A'],\n                            }}\n                            rootProps={{ 'data-testid': '6' }}\n                        />\n                        : \"\"\n                }\n            </div>\n        </div>\n    );\n}\n\nexport default Chart;","export default {\n    Keybinds: [\n        { key: 'g', code: '71', color: { r: '241', g: '112', b: '19', a: '1' }, behavior: \"Grooming\", active: false },\n        { key: 's', code: '83', color: { r: '41', g: '112', b: '200', a: '1' }, behavior: \"Scratching\", active: false }\n    ]\n};","import React, { useState, useEffect, useRef } from \"react\";\nimport \"./App.css\";\nimport 'fontsource-roboto';\nimport { withStyles } from '@material-ui/core/styles';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Chart from \"./components/Chart\"\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport ReactPlayer from \"react-player\";\nimport useEventListener from \"@use-it/event-listener\";\nimport KeybindMap from \"./hooks/keybindMap\"\nimport FolderIcon from '@material-ui/icons/Folder';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport MovieIcon from '@material-ui/icons/Movie';\nimport GetAppIcon from '@material-ui/icons/GetApp';\nimport KeyboardIcon from '@material-ui/icons/Keyboard';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport Divider from '@material-ui/core/Divider';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst SPACE_KEYS = ['32', ' '];\n\nconst useStyles = makeStyles((theme) => ({\n    button: {\n        padding: 0,\n    },\n    smallButton: {\n        marginTop: -4,\n        padding: 4,\n        '& svg': {\n            fontSize: 18\n        }\n    },\n    largeButton: {\n        display: 'block',\n        margin: 'auto',\n        '& svg': {\n            fontSize: 144,\n            color: \"#469FAE\"\n        }\n    },\n    toolbar: {\n        minHeight: 48,\n        maxHeight: 48,\n    },\n    title: {\n        flexGrow: 1,\n    },\n    menu: {\n        width: 'fit-content',\n        border: `1px solid ${theme.palette.divider}`,\n        borderRadius: theme.shape.borderRadius,\n        '& svg': {\n            margin: theme.spacing(1.5),\n        },\n        '& hr': {\n            margin: theme.spacing(0, 0.5),\n        },\n    },\n}));\n\nconst StyledMenu = withStyles({\n    paper: {\n        border: '1px solid #d3d4d5',\n    },\n})((props) => (\n    <Menu\n        elevation={0}\n        getContentAnchorEl={null}\n        anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'center',\n        }}\n        transformOrigin={{\n            vertical: 'top',\n            horizontal: 'center',\n        }}\n        {...props}\n    />\n));\n\nconst StyledMenuItem = withStyles((theme) => ({\n    root: {\n        '&:focus': {\n            backgroundColor: theme.palette.primary.main,\n            '& .MuiListItemIcon-root, & .MuiListItemText-primary': {\n                color: theme.palette.common.white,\n            },\n        },\n    },\n}))(MenuItem);\n\nfunction useInterval(callback, delay) {\n    const savedCallback = useRef();\n\n    useEffect(() => {\n        savedCallback.current = callback;\n    }, [callback]);\n\n    useEffect(() => {\n        let id = setInterval(() => {\n            savedCallback.current();\n        }, delay);\n        return () => clearInterval(id);\n    }, [delay]);\n}\n\nconst App = () => {\n    const [state, setState] = useState({\n        videoFilePath: '',\n        isPlaying: false,\n        duration: 0,\n        playedSeconds: 0,\n        loadedSeconds: 0,\n        keybinds: KeybindMap.Keybinds,\n        data: {\n            metadata: {},\n            events: []\n        }, // persisted data records\n        activeRecords: [], // activity record between keypress down and keypress up\n        derivedFields: []\n    });\n\n    // useInterval(() => {\n    //     setState(state);\n    // }, 10);\n\n    function resetVideo() {\n        hiddenInput.current.value = \"\";\n        setState({ ...state, videoFilePath: '', videoFileName: '' });\n    };\n\n    const handleDuration = (duration) => {\n        setState({ ...state, duration: duration });\n    };\n\n    const handleProgress = (progress) => {\n        setState({ ...state, playedSeconds: progress.playedSeconds, loadedSeconds: progress.loadedSeconds });\n    };\n\n    const handleVideoUpload = (event) => {\n        var uploadedFile = event.target.files[0];\n        if (uploadedFile) {\n            var video = document.createElement('video');\n            var videoFilePath = URL.createObjectURL(uploadedFile);\n            video.src = videoFilePath;\n            video.addEventListener('loadedmetadata', function () {\n                var duration = parseFloat(video.duration.toFixed(2));\n                setState({\n                    ...state,\n                    videoFilePath: videoFilePath,\n                    videoFileName: event.target.files[0].name,\n                    data: {\n                        metadata: {\n                            fileName: event.target.files[0].name,\n                            scoringDate: Date.now(),\n                            scoringDateText: new Date().toISOString(),\n                            duration: duration\n                        },\n                        events: []\n                    }\n                });\n                document.activeElement.blur();\n            });\n        }\n    };\n\n    const handleDownloadData = () => {\n        var dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(state.data));\n        var downloadAnchorNode = document.createElement('a');\n        downloadAnchorNode.setAttribute(\"href\", dataStr);\n        downloadAnchorNode.setAttribute(\"download\", state.videoFileName + \"-scored-behavior.json\");\n        document.body.appendChild(downloadAnchorNode); // required for firefox\n        downloadAnchorNode.click();\n        downloadAnchorNode.remove();\n    };\n\n    const handlePlayPause = () => {\n        setState({ ...state, isPlaying: !state.isPlaying });\n    };\n\n    const handleKeydown = (event) => {\n        if (state.videoFilePath !== '' && SPACE_KEYS.includes(String(event.key))) {\n            event.preventDefault();\n            handlePlayPause();\n        }\n\n        if (state.isPlaying)\n            handleKeyevent(event.key, recordKeydown);\n    }\n\n    const handleKeyup = ({ key }) => {\n        handleKeyevent(key, recordKeyup);\n    }\n\n    const handleKeyevent = (key, callback) => {\n        state.keybinds.forEach(function (keybind) {\n            if ((keybind.key === (String(key)) || keybind.code === (String(key)))) {\n                callback(keybind);\n            }\n        });\n\n    }\n\n    const recordKeydown = (keybind) => {\n        if (!keybind.active) {\n            keybind.active = true;\n            console.log(\"key down: \" + keybind.key + \" at \" + state.playedSeconds + \" secs\");\n\n            let activity = {\n                key: keybind.key,\n                behavior: keybind.behavior,\n                start: state.playedSeconds\n            };\n\n            let activeRecords = state.activeRecords;\n            activeRecords.push(activity);\n            setState({ ...state, activeRecords: activeRecords });\n            console.log(\"recorded activity start: \", activity);\n            console.log(state.activeRecords);\n        }\n    }\n\n    const recordKeyup = (keybind) => {\n        let activity = state.activeRecords.find(obj => { return obj.key === keybind.key });\n        let activeRecords = state.activeRecords.filter(obj => obj.key !== keybind.key);\n\n        if (activity) {\n            keybind.active = false;\n            console.log(\"key up: \" + keybind.key + \" at \" + state.playedSeconds + \" secs\");\n\n            activity.id = state.data.events.length;\n            activity.end = state.playedSeconds;\n\n            console.log(\"recorded activity end: \", activity);\n            console.log(state.activeRecords);\n\n            let dataEvents = state.data.events;\n            dataEvents.push(activity);\n\n            setState({\n                ...state,\n                activeRecords: activeRecords,\n                data: {\n                    events: dataEvents,\n                    metadata: {\n                        ...state.data.metadata\n                    }\n                }\n            });\n            console.log(state.data);\n        }\n\n    }\n\n    useEventListener('keydown', handleKeydown);\n    useEventListener('keyup', handleKeyup);\n\n    const classes = useStyles();\n    const hiddenInput = useRef(null);\n    const keybindMenu = useRef(null);\n\n    const [anchorEl, setAnchorEl] = useState(null);\n\n    const handleKeybindMenuClick = (event) => {\n        setAnchorEl(event.currentTarget);\n    };\n\n    const handleKeybindMenuClose = () => {\n        setAnchorEl(null);\n    };\n\n\n    return (\n        <div className=\"App\">\n            <input type=\"file\" ref={hiddenInput} onChange={handleVideoUpload} style={{ display: 'none' }} />\n            <StyledMenu\n                anchorEl={anchorEl}\n                keepMounted\n                open={Boolean(anchorEl)}\n                onClose={handleKeybindMenuClose}>\n                <StyledMenuItem>\n                    {state.isPlaying === false && state.playedSeconds === 0 && (\n                        <ListItemText primary=\"Start\" secondary=\"space\" align=\"center\" />\n                    )}\n                    {state.isPlaying === true && (\n                        <ListItemText primary=\"Pause\" secondary=\"space\" align=\"center\" />\n                    )}\n                    {state.isPlaying === false && state.playedSeconds > 0 && (\n                        <ListItemText primary=\"Resume\" secondary=\"space\" align=\"center\" />\n                    )}\n                </StyledMenuItem>\n                {state.keybinds.map((keybind) =>\n                    <StyledMenuItem key={keybind.key}>\n                        <ListItemText primary={keybind.behavior} secondary={keybind.key} align=\"center\" />\n                    </StyledMenuItem>\n                )}\n                {/* <StyledMenuItem>\n                    <ListItemIcon>\n                        <AddCircleIcon fontSize=\"small\" />\n                    </ListItemIcon>\n                    <ListItemText secondary=\"Add Keybind\" align=\"center\" />\n                </StyledMenuItem> */}\n            </StyledMenu>\n            <AppBar position=\"static\" style={{ background: '#469FAE' }}>\n                <Toolbar className={classes.toolbar}>\n                    <Typography variant=\"h5\" component=\"h1\" className={classes.title}>Behavior Recorder</Typography>\n                    <Grid container alignItems=\"center\" className={classes.menu}>\n                        <Tooltip title=\"Select Video\">\n                            <IconButton aria-label=\"select video\" color=\"inherit\" className={classes.button} onClick={(e) => hiddenInput.current.click()}>\n                                <MovieIcon />\n                            </IconButton>\n                        </Tooltip>\n                        <Divider orientation=\"vertical\" flexItem />\n                        <Tooltip title=\"Download Data\">\n                            <IconButton aria-label=\"download data\" color=\"inherit\" className={classes.button} onClick={handleDownloadData}>\n                                <GetAppIcon />\n                            </IconButton>\n                        </Tooltip>\n                        <Divider orientation=\"vertical\" flexItem />\n                        <Tooltip title=\"Keybinds\">\n                            <IconButton aria-label=\"keybinds\"\n                                color=\"inherit\"\n                                aria-haspopup=\"true\"\n                                onClick={handleKeybindMenuClick}\n                                className={classes.button}>\n                                <KeyboardIcon />\n                            </IconButton>\n                        </Tooltip>\n                        {/* <Divider orientation=\"vertical\" flexItem />\n                        <Tooltip title=\"Data\">\n                            <IconButton aria-label=\"data\" color=\"inherit\" className={classes.button}>\n                                <FolderIcon />\n                            </IconButton>\n                        </Tooltip>\n                        <Divider orientation=\"vertical\" flexItem />\n                        <Tooltip title=\"Settings\">\n                            <IconButton aria-label=\"settings\" color=\"inherit\" className={classes.button}>\n                                <SettingsIcon />\n                            </IconButton>\n                        </Tooltip> */}\n                    </Grid>\n                </Toolbar>\n            </AppBar>\n            {state.videoFilePath ?\n                <Typography variant=\"button\" display=\"block\" align=\"center\" gutterBottom>\n                    Current Video: {state.videoFileName}\n                    <Tooltip title=\"Unset Video\">\n                        <IconButton aria-label=\"unset video\" color=\"inherit\" className={classes.smallButton} onClick={resetVideo}>\n                            <CancelIcon />\n                        </IconButton>\n                    </Tooltip>\n                </Typography>\n                : \"\"}\n            {!state.videoFilePath ?\n                <div>\n                    <Typography variant=\"button\" display=\"block\" align=\"center\" gutterBottom>\n                        No video selected\n                    </Typography>\n                    <Tooltip title=\"Select Video\">\n                        <IconButton aria-label=\"select video\" color=\"inherit\" className={classes.largeButton} onClick={(e) => hiddenInput.current.click()}>\n                            <MovieIcon />\n                        </IconButton>\n                    </Tooltip>\n                </div>\n                : \"\"}\n            <div className=\"Row\">\n                <div className=\"VideoPlay\">\n                    <ReactPlayer url={state.videoFilePath}\n                        className=\"ReactPlayer\"\n                        playing={state.isPlaying}\n                        width=\"840px\"\n                        height=\"100%\"\n                        controls={true}\n                        onDuration={handleDuration}\n                        onProgress={handleProgress}\n                    />\n                    <div className=\"Row\">\n                        <Chart state={state} />\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default App;","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));"],"sourceRoot":""}